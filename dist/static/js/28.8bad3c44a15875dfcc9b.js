webpackJsonp([28],{"5L9H":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("mvHQ"),s=i.n(n),a=i("ZKg9"),o=i("/nBy"),r=(o.a,a.a,{name:"refund",data:function(){return{api:this.GLOBAL.baseURL,index:1,value:1,house:[],options:[{label:"全退",value:1},{label:"非全退",value:0}],reson:"",orderInformation:"",pay_refund:"",balance:"",total_price:"",order_id:"",isLoading:!1,returnFace:"",disabled:!1,combineL:[],adult_num:0,kids_num:0,person_a:0,person_k:0}},components:{Loading:o.a,LoadingImg:a.a},computed:{isChoose:function(t,e){return function(t,e){return-1!=this.combineL.indexOf(t.combine_id)}}},watch:{value:function(){this.getHouseNum()}},methods:{chooseCombine:function(t,e){if(-1==this.combineL.indexOf(t.combine_id))this.combineL.push(t.combine_id);else{var i=this.combineL.indexOf(t.combine_id);this.combineL.splice(i,1)}this.getHouseNum()},goBack:function(){2==this.index?this.$router.push("/transaction"):this.$router.go(-1)},reduceP:function(t){1==t?(this.person_a-=1,this.getHouseNum()):(this.person_a+=1,this.getHouseNum())},reduceK:function(t){1==t?(this.person_k-=1,this.getHouseNum()):(this.person_k+=1,this.getHouseNum())},reduceH:function(t,e){1==e?(t.number-=1,this.getHouseNum()):(t.number+=1,this.getHouseNum())},getHouseNum:function(){for(var t=[],e=0;e<this.orderInformation.house.length;e++)this.orderInformation.house[e].number&&t.push({oh_id:this.orderInformation.house[e].oh_id,num:this.orderInformation.house[e].number});this.getAmount(s()(t))},sendRefun:function(){var t=this;this.isLoading=!0;for(var e=[],i=0;i<this.orderInformation.house.length;i++)this.orderInformation.house[i].number&&e.push({oh_id:this.orderInformation.house[i].oh_id,num:this.orderInformation.house[i].number});this.$http.post(this.api+"/RefundSTwo",{token:localStorage.getItem("token"),verson:2,order_id:this.order_id,person_num:this.value?this.adult_num:this.person_a,house:this.value?"":s()(e),kids_num:this.value?this.kids_num:this.person_k,combine:this.value?"":s()(this.combineL),flag:this.value,reason:this.reson,type:0}).then(function(e){1==e.data.code?(t.isLoading=!1,t.pay_refund?t.index=2:t.$message({type:"success",message:"您的退款将会根据该活动退款政策在2-3个工作日进行退款！"}),t.$router.push("/refundOrder")):3==e.data.code?t.sendRefun():0==e.data.code&&(t.isLoading=!1,t.$message({type:"error",message:e.data.msg}))})},checkRefund:function(){var t=this;this.$http.post(this.api+"/CheckPolicy",{token:localStorage.getItem("token"),order_id:this.order_id}).then(function(e){1==e.data.code?t.pay_refund=1:3==e.data.code?t.$http.post(t.api+"/home/index/token").then(function(e){localStorage.setItem("token",e.data.data),t.checkRefund()}):t.pay_refund=0})},getAmount:function(t){var e=this;this.$http.post(this.api+"/RefundAmountTwo",{token:localStorage.getItem("token"),verson:2,order_id:this.order_id,person_num:0==this.value?this.person_a:"",house:0==this.value?t:"",reason:this.reason,kids_num:0==this.value?this.person_k:"",combine:0==this.value?s()(this.combineL):"",flag:this.value}).then(function(i){1==i.data.code?(e.balance=i.data.data.balance,e.total_price=i.data.data.pay_price.toFixed(2)):3==i.data.code?e.$http.post(e.api+"/home/index/token").then(function(i){localStorage.setItem("token",i.data.data),e.getAmount(order,person,t,reason,flag)}):0==i.data.code&&alert(i.data.msg)})},getOrderMation:function(){var t=this;this.$http.post(this.api+"/OrderRefundDTwo",{token:localStorage.getItem("token"),order_id:this.order_id}).then(function(e){if(1==e.data.code){var i=e.data.data;console.log(i);for(var n=0;n<i.detail.length;n++)"0"==i.detail[n].type&&(t.adult_num=i.detail[n].adult,t.kids_num=i.detail[n].kids);for(n=0;n<i.house.length;n++)i.house[n].number=0;t.orderInformation=i,console.log(t.orderInformation)}else 3==e.data.code?t.$http.post(t.api+"/home/index/token").then(function(e){localStorage.setItem("token",e.data.data),t.getOrderMation()}):0==e.data.code&&alert(e.data.msg)})}},mounted:function(){this.getOrderMation(),this.checkRefund(),this.getAmount()},created:function(){this.order_id=this.$route.query.information,this.returnFace=this.$route.query.returnFace,this.returnFace?(this.disabled=!0,this.value=2):(this.disabled=!1,this.value=1)}}),l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fontweight",staticStyle:{"text-align":"left"}},[i("div",{staticStyle:{"background-color":"#fff",padding:"20px"}},[t._m(0),t._v(" "),i("div",{staticClass:"flexBetween",staticStyle:{"margin-top":"15px"}},[i("div",{class:[1==t.index?"mainBackColor":"defultColor"],staticStyle:{height:"25px",width:"50%","text-align":"center","line-height":"25px","font-size":"12px"}},[t._v("退款申请")]),t._v(" "),i("div",{class:[2==t.index?"mainBackColor":"defultColor"],staticStyle:{"text-align":"center",width:"50%","line-height":"25px","font-size":"12px"}},[t._v("退款成功")])]),t._v(" "),t.orderInformation?i("div",[1==t.index?i("div",{staticStyle:{"margin-top":"15px","font-size":"12px"}},[i("div",{staticClass:"flexStart"},[t._m(1),t._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"flex-start","margin-left":"15px","margin-top":"10px"}},[i("LoadingImg",{staticStyle:{width:"100px",height:"70px"},attrs:{type:"new2",src:t.orderInformation.cover_image?t.orderInformation.cover.domain+t.orderInformation.cover.themb_url:""}}),t._v(" "),i("div",{staticClass:"flexColumn",staticStyle:{"margin-left":"12px",height:"70px"}},[i("p",[t._v(t._s(t.orderInformation.title))]),t._v(" "),i("p",[t._v("策划人："),i("b",[t._v(t._s(t.orderInformation.user.family_name+t.orderInformation.user.middle_name+t.orderInformation.user.name?t.orderInformation.user.family_name+"·"+t.orderInformation.user.middle_name+"·"+t.orderInformation.user.name:"匿名用户"))])])])],1)]),t._v(" "),i("div",{staticStyle:{"line-height":"30px"}},[i("p",[t._v("参与人数："+t._s(t.orderInformation.num)+"人")]),t._v(" "),i("p",[t._v("体验地点："+t._s(t.orderInformation.place))]),t._v(" "),i("p",[t._v("体验时长："+t._s(t.orderInformation.total_time))]),t._v(" "),i("p",[t._v("体验时间："+t._s(t.orderInformation.activ_begin_time)+"—"+t._s(t.orderInformation.activ_end_time))])]),t._v(" "),i("hr",{staticClass:"line"}),t._v(" "),i("div",[i("div",{staticClass:"flexStart"},[i("div",[t._v("价格详情：")]),t._v(" "),i("div",t._l(t.orderInformation.detail,function(e,n){return i("div",{staticClass:"marginTop"},["1"==e.type||"2"==e.type?i("div",[t._v("\n                  "+t._s("1"==e.type?"亲子":e.name)),i("span",{staticClass:"marginLeft"}),t._v(t._s(e.adult)+"成人"),"1"==e.type?i("span",[t._v(t._s(e.kids)+"儿童")]):t._e(),t._v(" "),i("span",{staticClass:"marginLeft"}),t._v("¥"+t._s(e.price)+"\n                ")]):t._e(),t._v(" "),"0"==e.type?i("div",[i("div",{staticClass:"marginTop"},[t._v("标准"),i("span",{staticClass:"marginLeft"}),t._v(t._s(e.adult)+"人"),i("span",{staticClass:"marginLeft"}),t._v("¥"+t._s(e.adult_price))]),t._v(" "),i("div",[t._v("儿童"),i("span",{staticClass:"marginLeft"}),t._v(t._s(e.kids)+"人"),i("span",{staticClass:"marginLeft"}),t._v("¥"+t._s(e.kids_price))])]):t._e()])}))]),t._v(" "),i("div",{staticClass:"flexStart"},[i("div",[t._v("预定住宿：")]),t._v(" "),i("div",t._l(t.orderInformation.house,function(e,n){return i("p",{staticClass:"marginTop"},[i("span",[t._v(t._s(e.title))]),t._v(" "),i("span",{staticClass:"marginLeft"}),t._v(" "),i("span",[t._v("房数"),i("i",{staticClass:"el-icon-close"}),t._v(t._s(e.num))]),t._v(" "),i("span",{staticClass:"marginLeft"}),t._v(" "),i("span",[t._v("总额￥ "+t._s(e.price))])])}))])]),t._v(" "),i("hr",{staticClass:"line"}),t._v(" "),i("div",{staticClass:"flexStart "},[t._m(2),t._v(" "),i("div",{staticStyle:{"margin-left":"9px"}},[i("el-select",{staticStyle:{width:"410px"},attrs:{disabled:t.disabled,placeholder:"请选择退款方式"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)]),t._v(" "),0==t.value?i("div",[i("div",{staticClass:"flexStart marginBottom"},[t._m(3),t._v(" "),i("div",{staticStyle:{"margin-left":"9px"}},t._l(t.orderInformation.detail,function(e,n){return i("div",{staticClass:"marginTop"},["1"==e.type||"2"==e.type?i("div",{staticClass:"flexStart"},[i("div",{staticStyle:{cursor:"pointer",width:"12px",height:"12px","border-radius":"50%",border:"1px solid rgba(195,195,195,1)"},style:{backgroundColor:t.isChoose(e,n)?"#14c5ca":"#fff"},on:{click:function(i){t.chooseCombine(e,n)}}}),t._v(" "),i("div",{staticStyle:{"margin-left":"9px","line-height":"14px"}},[t._v("\n                      "+t._s("1"==e.type?"亲子":e.name)),i("span",{staticClass:"marginLeft"}),t._v(t._s(e.adult)+"成人"),"1"==e.type?i("span",[t._v(t._s(e.kids)+"儿童")]):t._e(),t._v(" "),i("span",{staticClass:"marginLeft"}),t._v("¥"+t._s(e.price)+"\n                  ")])]):t._e()])}))]),t._v(" "),i("div",{staticClass:"marginBottom flexStart"},[t._m(4),t._v(" "),i("div",{staticClass:"marginLeft"},[i("div",{staticClass:"flexStart "},[i("div",{staticStyle:{"line-height":"40px"}},[t._v("标准人数")]),t._v(" "),i("div",{staticClass:"flexStart",staticStyle:{"margin-left":"17px"}},[i("el-button",{staticStyle:{"margin-top":"5px",border:"1px solid #008489",color:"#008489",width:"30px",height:"30px"},attrs:{disabled:0==t.person_a,icon:"el-icon-minus",size:"mini",circle:""},on:{click:function(e){t.reduceP(1)}}}),t._v(" "),i("span",{staticStyle:{"line-height":"40px",margin:"0 10px"}},[t._v(t._s(t.person_a))]),t._v(" "),i("el-button",{staticStyle:{"margin-top":"5px",border:"1px solid #008489",color:"#008489",width:"30px",height:"30px"},attrs:{disabled:t.person_a==t.adult_num,icon:"el-icon-plus",size:"mini",circle:""},on:{click:function(e){t.reduceP(2)}}})],1)]),t._v(" "),i("div",{staticClass:"flexStart"},[i("div",{staticStyle:{"line-height":"40px"}},[t._v("儿童人数")]),t._v(" "),i("div",{staticClass:"flexStart",staticStyle:{"margin-left":"17px"}},[i("el-button",{staticStyle:{"margin-top":"5px",border:"1px solid #008489",color:"#008489",width:"30px",height:"30px"},attrs:{disabled:0==t.person_k,icon:"el-icon-minus",size:"mini",circle:""},on:{click:function(e){t.reduceK(1)}}}),t._v(" "),i("span",{staticStyle:{"line-height":"40px",margin:"0 10px"}},[t._v(t._s(t.person_k))]),t._v(" "),i("el-button",{staticStyle:{"margin-top":"5px",border:"1px solid #008489",color:"#008489",width:"30px",height:"30px"},attrs:{disabled:t.person_k==t.kids_num,icon:"el-icon-plus",size:"mini",circle:""},on:{click:function(e){t.reduceK(2)}}})],1)])])]),t._v(" "),t.orderInformation.house.length?i("div",{staticClass:"flexStart marginBottom"},[t._m(5),t._v(" "),i("div",{staticStyle:{display:"flex","flex-direction":"column","margin-left":"9px"}},t._l(t.orderInformation.house,function(e){return i("div",{staticStyle:{display:"flex","justify-content":"flex-start","margin-bottom":"15px"}},[i("div",{staticStyle:{"margin-left":"10px","line-height":"40px"}},[i("p",[t._v(t._s(e.title)+"房数")])]),t._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"flex-start","margin-left":"20px","line-height":"30px","margin-top":"5px"}},[i("el-button",{staticStyle:{border:"1px solid #008489",color:"#008489",width:"30px",height:"30px"},attrs:{disabled:0==e.number,icon:"el-icon-minus",size:"mini",circle:""},on:{click:function(i){t.reduceH(e,1)}}}),t._v(" "),i("div",{staticStyle:{margin:"0 10px"}},[i("b",[t._v(t._s(e.number))])]),t._v(" "),i("el-button",{staticStyle:{border:"1px solid #008489",color:"#008489",width:"30px",height:"30px"},attrs:{disabled:e.number==e.num,icon:"el-icon-plus",size:"mini",circle:""},on:{click:function(i){t.reduceH(e,2)}}})],1)])}))]):t._e()]):t._e(),t._v(" "),i("div",{staticStyle:{"margin-top":"25px",display:"flex","justify-content":"flex-start"}},[t._m(6),t._v(" "),i("div",{staticStyle:{"margin-left":"9px"}},[i("el-input",{staticStyle:{width:"410px"},attrs:{type:"textarea",rows:4},model:{value:t.reson,callback:function(e){t.reson=e},expression:"reson"}})],1)]),t._v(" "),i("hr",{staticClass:"line"}),t._v(" "),i("p",{staticStyle:{"text-align":"right"}},[t._v("订单退款总额：￥  "+t._s(t.total_price))]),t._v(" "),i("div",{staticClass:"marginBottom",staticStyle:{display:"flex","justify-content":"flex-end"}},[i("span",{staticStyle:{"font-size":"9px",color:"#999999","line-height":"23px",cursor:"pointer"},on:{click:t.goBack}},[t._v("取消退款")]),t._v(" "),i("div",{staticClass:"mainButton",staticStyle:{"margin-left":"27px"},on:{click:t.sendRefun}},[t._v("提交申请")])])]):t._e(),t._v(" "),2==t.index?i("div",{staticStyle:{"margin-top":"50px"}},[t._m(7),t._v(" "),t._m(8)]):t._e()]):t._e()]),t._v(" "),t.isLoading?i("div",{staticStyle:{position:"fixed",top:"0",right:"0",bottom:"0","background-color":"rgba(255,255,255,.5)",left:"0",display:"flex","justify-content":"center","align-items":"center","z-index":"999"}},[i("Loading")],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticStyle:{"line-height":"40px","font-size":"14px"}},[e("h4",[this._v("已支付订单>退款申请")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{height:"50px","line-height":"90px"}},[e("b",[this._v("退款活动")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"line-height":"40px"}},[e("b",[this._v("退款方式 "),e("span",{staticStyle:{color:"#F73737"}},[this._v("*")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"fontweight",staticStyle:{width:"70px"}},[this._v("退订套餐 "),e("span",{staticStyle:{color:"#F73737"}},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"line-height":"40px"}},[e("b",[this._v("退款人数 "),e("span",{staticStyle:{color:"#F73737"}},[this._v("*")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"line-height":"40px"}},[e("b",[this._v("退款住宿 "),e("span",{staticStyle:{color:"#F73737"}},[this._v("*")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"line-height":"40px"}},[e("b",[this._v("退款原因 "),e("span",{staticStyle:{color:"#F73737"}},[this._v("*")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-start",color:"#008489"}},[e("div",[e("i",{staticClass:"el-icon-circle-check",staticStyle:{"font-size":"24px"}})]),this._v(" "),e("div",{staticStyle:{"font-size":"12px","margin-left":"11px","line-height":"24px"}},[this._v("\n              退款成功\n            ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"margin-top":"16px",color:"#999999","text-align":"center","font-size":"12px"}},[e("p",[this._v("您的金额已退回原始钱包中")])])}]};var c=i("VU/8")(r,l,!1,function(t){i("5wMA")},"data-v-f58e62ce",null);e.default=c.exports},"5wMA":function(t,e){}});
//# sourceMappingURL=28.8bad3c44a15875dfcc9b.js.map