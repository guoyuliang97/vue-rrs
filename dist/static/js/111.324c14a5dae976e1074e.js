webpackJsonp([111],{V4pB:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("/nBy"),n=a("Lt3X"),o=(n.a,i.a,{data:function(){return{api:this.GLOBAL.baseURL,activeName:"first",replay:"说点什么...",overflow:"hidden",height:"78px",review:{text:""},isLogin:!0,imgUrl:"",isReplay:!1,otherList:[],commenImg:"../../../static/img/static/user.png",replayId:"",flag:"",myConment:[],isLoading:!1}},components:{Person:n.a,Loading:i.a},methods:{getToMe:function(t){var e=this;this.isLoading=!0,this.$http.post(this.api+"/msgreply",{token:localStorage.getItem("token"),page:t}).then(function(a){1==a.data.code?(e.otherList=a.data.data.data,e.isLoading=!1):3==a.data.code?e.$http.post(e.api+"/home/index/token").then(function(a){localStorage.setItem("token",a.data.data),e.getToMe(t)}):0==a.data.code&&alert(a.data.msg)})},abolish:function(){this.review.text="",this.height="78px",this.overflow="hidden",this.replay="说点什么..."},textareaFocus:function(){this.height="auto",this.overflow="none"},discuss:function(){var t=this;this.replayId&&this.$http.post(this.api+"/home/Comment/save_leavemsg",{token:localStorage.getItem("token"),flag:2==this.flag||5==this.flag?5:4==this.flag?4:3,content:this.review.text,table_id:this.replayId}).then(function(e){1==e.data.code?(t.review.text="",t.$message({message:"评论成功",type:"success"})):3==e.data.code?t.$http.post(t.api+"/home/index/token").then(function(e){localStorage.setItem("token",e.data.data),t.discuss()}):0==e.data.code&&alert(e.data.msg)})},sendReplay:function(t){console.log(t),document.getElementById("textarea").focus(),this.replayId=t.say_id,this.flag=t.flag_comm,this.replay="回复给"+t.family_name+t.middle_name+t.name},getMy:function(t){var e=this;this.$http.post(this.api+"/msgsay",{token:localStorage.getItem("token"),page:t}).then(function(a){1==a.data.code?e.myConment=a.data.data.data:3==a.data.code?e.$http.post(rhis.api+"/home/index/token").then(function(a){localStorage.setItem("token",a.data.data),e.getMy(t)}):0==a.data.code&&alert(a.data.msg)})},handClick:function(){"second"==this.activeName?this.getMy(1):this.getToMe(1)},deleteCo:function(t,e){var a=this;this.$confirm("此操作将永久删除该评论, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.reduceComment(t,e),a.$message({type:"success",message:"删除成功!"})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},reduceComment:function(t,e){var a=this;1==t.flag||6==t.flag?this.$http.post(this.api+"/home/Comment/del_comment",{token:localStorage.getItem("token"),comment_id:t.say_id}).then(function(i){1==i.data.code?a.getMy(1):3==i.data.code?a.$http.post(a.api+"/home/index/token").then(function(i){localStorage.setItem("token",i.data.data),a.reduceComment(t,e)}):0==i.data.code&&alert(i.data.msg)}):4!=t.flag&&7!=t.flag||this.$http.post(this.api+"/home/Comment/del_leavemsg",{token:localStorage.getItem("token"),msg_id:t.say_id}).then(function(i){1==i.data.code?a.getMy(1):3==i.data.code?a.$http.post(a.api+"/home/index/token").then(function(i){localStorage.setItem("token",i.data.data),a.reduceComment(t,e)}):0==i.data.code&&alert(i.data.msg)})}},mounted:function(){this.getToMe(1),localStorage.getItem("userImg")?this.imgUrl=localStorage.getItem("userImg"):this.imgUrl=this.commenImg}}),s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-tabs",{on:{"tab-click":t.handClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"对您的评价",name:"first"}},[a("div",{staticStyle:{width:"740px",margin:"0 auto","text-align":"left"}},[a("Person",{staticStyle:{"padding-right":"20px"},attrs:{type:"discuss",isLogin:t.isLogin,replay:t.replay,imgUrl:t.imgUrl,overflow:t.overflow,review:t.review,height:t.height},on:{textareaFocus:t.textareaFocus,abolish:t.abolish,discuss:t.discuss}})],1),t._v(" "),a("div",{staticClass:"data_title",staticStyle:{"margin-top":"15px"}},[a("div",{staticClass:"edit_width"},[t._v("过往的评价")])]),t._v(" "),a("div",[a("div",{staticStyle:{width:"740px",margin:"0 auto","text-align":"left"}},t._l(t.otherList,function(e,i){return a("div",{staticStyle:{"font-size":"12px",padding:"13px 0","border-bottom":"1px solid #E6E6E6"}},[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[a("div",[a("img",{staticStyle:{"border-radius":"50%"},attrs:{src:e.domain?e.domain+e.image_url:t.commenImg,width:"48px",height:"48px"}})]),t._v(" "),a("div",{staticStyle:{"margin-left":"10px","line-height":"50px"}},[a("p",[a("b",[t._v(t._s(e.family_name+e.middle_name+e.name?e.family_name+e.middle_name+e.name:"匿名用户"))])])])]),t._v(" "),a("div",[a("span",{staticStyle:{color:"#14c5ca"}},[t._v("赞("+t._s(e.praise_num)+")")])])]),t._v(" "),a("div",{staticStyle:{"margin-top":"15px",display:"flex","justify-content":"space-between"}},[a("div",[t._v("回复我："+t._s(e.content)),a("span",{staticStyle:{color:"#14c5ca","margin-left":"10px"},on:{click:function(a){t.sendReplay(e,i)}}},[t._v("回复")])]),t._v(" "),a("div",[t._v("«"+t._s(e.title)+"»")])]),t._v(" "),e.top_content?a("div",{staticStyle:{"background-color":"#F4F4F4",padding:"0 10px","line-height":"25px","margin-top":"10px"}},[t._v("\n                我的评论："+t._s(e.top_content)+"\n              ")]):t._e()])}))])]),t._v(" "),a("el-tab-pane",{attrs:{label:"您写的评价",name:"second"}},[a("div",{staticClass:"data_title",staticStyle:{"margin-top":"15px"}},[a("div",{staticClass:"edit_width"},[t._v("您过往写的评论")])]),t._v(" "),a("div",[a("div",{staticStyle:{width:"740px",margin:"0 auto","text-align":"left"}},t._l(t.myConment,function(e,i){return a("div",{staticStyle:{"font-size":"12px",padding:"13px 0","border-bottom":"1px solid #E6E6E6"}},[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[a("div",[a("img",{staticStyle:{"border-radius":"50%"},attrs:{src:t.imgUrl,width:"48px",height:"48px"}})]),t._v(" "),a("div",{staticStyle:{"margin-left":"10px","line-height":"50px"}},[a("p",[a("b",[t._v(t._s(e.name))])])])]),t._v(" "),a("div",[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){t.deleteCo(e,i)}}},[t._v("删除")]),a("span",{staticStyle:{"margin-left":"10px",color:"#14c5ca",cursor:"pointer"}},[t._v("赞("+t._s(e.leaving_num)+")")])])]),t._v(" "),a("div",{staticStyle:{"margin-top":"15px",display:"flex","justify-content":"space-between"}},[a("div",[t._v(t._s(e.content))]),t._v(" "),a("div",[t._v("«"+t._s(e.title)+"»")])])])}))])])],1),t._v(" "),t.isLoading?a("div",{staticStyle:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0","z-index":"999","background-color":"rgba(255,255,255,.8)",display:"flex","justify-content":"center","align-items":"center"}},[a("Loading")],1):t._e()],1)},staticRenderFns:[]};var l=a("VU/8")(o,s,!1,function(t){a("nPN4")},null,null);e.default=l.exports},nPN4:function(t,e){}});
//# sourceMappingURL=111.324c14a5dae976e1074e.js.map