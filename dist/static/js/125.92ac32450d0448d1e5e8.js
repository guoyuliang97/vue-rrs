webpackJsonp([125],{VE2d:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("a20G"),n=o("uTVu"),i=o("/nBy"),s=o("4hmb"),d=(s.a,i.a,a.a,{data:function(){return{api:this.GLOBAL.baseURL,img:"./static/img/home/1.jpg",recommendedList:[],wonderfulList:[],isLoading:!1,loadingState:!1,page:1,request:!1}},components:{Detail:s.a,Loading:i.a,None:a.a},methods:{getStory:function(t){var e=this;this.$http.post(this.api+"/home/Story/story_list",{token:localStorage.getItem("token"),sort:2,page:t}).then(function(o){if(1==o.data.code){for(var a=o.data.data.data,n=0;n<a.length;n++)e.wonderfulList.push(a[n]);a.length?e.request=!1:e.request=!0,e.isLoading=!1,e.loadingState=!1}else 3==o.data.code?e.$http.post(e.api+"/home/Index/token").then(function(o){localStorage.setItem("token",o.data.data),e.getStory(t)}):alert(o.data.msg)})},toperson:function(t,e){this.$router.push({path:"/userdata",query:{information:t.userId}})},toStory:function(t,e){this.$router.push({path:"/storyPage",query:{information:t.story_id}})},addZan:function(t,e){var o=this;0==t.zanIndex?this.$http.post(this.api+"/home/Comment/praise",{token:localStorage.getItem("token"),flag:1,table_id:t.story_id,type:1}).then(function(a){1==a.data.code?(t.zanIndex=1,t.zan=t.zan+1):3==a.data.code?o.$http.post(o.api+"/home/index/token").then(function(a){localStorage.setItem("token",a.data.data),o.addZan(t,e)}):alert(a.data.msg)}):this.$http.post(this.api+"/home/Comment/praise",{token:localStorage.getItem("token"),flag:1,table_id:t.story_id,type:2}).then(function(a){1==a.data.code?(t.zan=t.zan-1,t.zanIndex=0):3==a.data.code?o.$http.post(o.api+"/home/index/token").then(function(a){localStorage.setItem("token",a.data.data),o.addZan(t,e)}):alert(a.data.msg)})},onScroll:function(){var t=document.documentElement.scrollTop||document.body.scrollTop,e=document.documentElement.clientHeight||document.body.clientHeight;(document.documentElement.scrollHeight||document.body.scrollHeight)==t+e&&(this.request||(this.loadingState=!0,this.page+=1,this.getStory(this.page)))},getHotLocal:function(){var t=this;this.$http.post(this.api+"/PopularCityStory",{token:localStorage.getItem("token")}).then(function(e){1==e.data.code?(t.recommendedList=e.data.data,n.a.$emit("hotPlace",e.data.data)):3==e.data.code||alert(e.data.msg)})},toSearch:function(t){this.$router.push({name:"homeSearch",query:{key:t.city,type:1}})}},mounted:function(){window.addEventListener("scroll",this.onScroll),this.isLoading=!0,this.getStory(this.page),this.getHotLocal()},destroyed:function(){window.removeEventListener("scroll",this.onScroll)}}),r={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"wonderful_con"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.recommendedList.length,expression:"recommendedList.length"}]},[o("p",{staticClass:"title"},[t._v("推荐搜索")]),t._v(" "),o("div",{staticClass:"recommended_list"},t._l(t.recommendedList,function(e,a){return a<6?o("div",{staticClass:"recommended_detail",style:{backgroundImage:"url("+e.img+")",backgroundSize:"100% 100%"}},[o("div",{staticClass:"recommended_bg fontweight",on:{click:function(o){t.toSearch(e)}}},[o("p",{staticClass:"recommended_name"},[t._v(t._s(e.city))])])]):t._e()}))]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.wonderfulList.length,expression:"wonderfulList.length"}]},[o("p",{staticClass:"title"},[t._v("精选故事")]),t._v(" "),o("div",{staticClass:"select_list"},t._l(t.wonderfulList,function(e,a){return o("div",{staticClass:"select_detail"},[o("Detail",{attrs:{type:"2",data:e},on:{toperson:function(o){t.toperson(e,a)},toStory:function(o){t.toStory(e,a)},addZan:function(o){t.addZan(e,a)}}})],1)}))]),t._v(" "),o("Loading",{directives:[{name:"show",rawName:"v-show",value:t.loadingState,expression:"loadingState"}]}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticStyle:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"#fff","z-index":"999"}},[o("Loading",{staticStyle:{position:"fixed",top:"50%",left:"50%","z-index":"9999"}})],1),t._v(" "),t.wonderfulList.length?t._e():o("div",[o("None",{attrs:{type:"story"}})],1),t._v(" "),t.request?o("p",{staticStyle:{"font-size":"12px",margin:"30px 0"}},[t._v("············没有更多故事了！快去发布吧！············")]):t._e()],1)},staticRenderFns:[]};var l=o("VU/8")(d,r,!1,function(t){o("tivN")},null,null);e.default=l.exports},tivN:function(t,e){}});
//# sourceMappingURL=125.92ac32450d0448d1e5e8.js.map