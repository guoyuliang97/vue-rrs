webpackJsonp([146],{"4iW1":function(t,e){},"8T2H":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("dbwY"),n=i("4hmb"),s=i("a20G"),o=i("/nBy"),l=i("PhFL"),r=i("DjrJ"),c=(i("uTVu"),i("ZKg9")),d=(r.a,l.a,c.a,o.a,s.a,n.a,a.a,{name:"moreActive",data:function(){return{api:this.GLOBAL.baseURL,defultUserImg:"../../static/img/static/user.png",defultImg:"../../static/img/static/default.png",date:"",person:"",addClick:!1,otherList:[{person:"成人+",adult:0}],tiyan:"",imgUrl:"../../static/img/static/back.jpg",false:!1,adress:"",closeIndex:"",price:[0,0],activeList:[],pickerOptions2:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},pageIndex:1,total:0,allprice:"",allperson:"",editSearch:"搜索",content:"",isLoading:!1,cityData:"",mapIndex:1,westSouth:"",eastNorth:"",adreeList:[],map:"",markerIndex:"",country:"",province:"",city:"",xian:"",xianList:[],priceArr:[]}},components:{Head:r.a,Map:l.a,loadingImg:c.a,Loading:o.a,None:s.a,Detail:n.a,City:a.a},watch:{content:function(){this.content||this.getall()},allperson:function(){this.allperson<17?this.getall():this.addClick=!0},date:function(){this.getall()},allprice:function(){this.getall()},tiyan:function(){this.getall()},closeIndex:function(){this.getall()},westSouth:function(){this.getActive(1)},adreeList:function(){this.map.clearOverlays(),this.addMarker()}},methods:{checkXian:function(t){this.xianList=t},selectCountry:function(t){this.country=t[1],this.getall()},selectProvince:function(t){this.province=t[1],this.getall()},selectCity:function(t){this.city=t[1],this.adress=this.city,this.creatMap(),this.getall()},selectXian:function(t){this.xian=t[1],this.getall()},changeColorIndex:function(t,e){this.markerIndex=e;for(var i=document.getElementsByClassName("markerStyle"),a=document.getElementsByClassName("arrowStyle"),n=0;n<i.length;n++)n==this.markerIndex?(i[n].style.backgroundColor="#008489",i[n].style.zIndex="2",i[n].style.color="white"):(i[n].style.backgroundColor="white",i[n].style.zIndex="1",i[n].style.color="#000");for(n=0;n<a.length;n++)n==this.markerIndex?a[n].style.borderTopColor="#008489":a[n].style.borderTopColor="rgba(255,255,255,1)"},Mwpchange:function(){var t=document.getElementsByClassName("mapStyle")[0],e=document.getElementsByClassName("activeList")[0];this.mapIndex?(this.mapIndex=0,t.style.display="none",e.style.width="98%",window.scroll(0,0),this.getActive(1)):(this.mapIndex=1,t.style.display="block",e.style.width="45%",window.scroll(0,0),this.getActive(1))},chooseMoney:function(t){1==t?this.allperson=this.person:this.allprice=this.price},getall:function(){this.getActive(this.pageIndex,this.price[0],this.price[1],this.date?this.date[0]/1e3:0,this.date?this.date[1]/1e3:0,this.tiyan,this.closeIndex,this.allperson)},show:function(){var t=this;this.$nextTick(function(){t.$refs.saveDateInput.focus()})},reduce:function(t,e){if(0==e){if(t.adult>0){this.addClick=!1,t.adult=t.adult-1;for(var i=0,a=0;a<this.otherList.length;a++)i+=this.otherList[a].adult;this.person=i}}else if(0!=t.adult){this.addClick=!1,t.adult=t.adult-1;for(var n=0,s=0;s<this.otherList.length;s++)n+=this.otherList[s].adult;this.person=n}else t.adult=0},add:function(t,e){if(this.person<16){this.addClick=!1,t.adult=t.adult+1;for(var i=0,a=0;a<this.otherList.length;a++)i+=this.otherList[a].adult;this.person=i}else this.addClick=!0},rejest:function(){this.price=[0,0]},change:function(){this.closeIndex?this.closeIndex="":this.closeIndex=1},getActive:function(t,e,i,a,n,s,o,l){var r=this;this.isLoading=!0,this.$http.post(this.api+"/ActivityListUserTwo",{token:localStorage.getItem("token"),verson:2,keywords:this.content,page:t,price_low:e,price_high:i,activ_begin_time:a,activ_end_time:n,kind_id:s,is_volunteen:o,max_person_num:l,lat_begin:this.mapIndex?this.westSouth[1]:"",lat_end:this.mapIndex?this.eastNorth[1]:"",lng_begin:this.mapIndex?this.westSouth[0]:"",lng_end:this.mapIndex?this.eastNorth[0]:"",country:this.country?this.country:"",province:this.province?this.province:"",city:this.adress,region:this.xian?this.xian:""}).then(function(c){if(1==c.data.code){r.total=c.data.data.total,r.activeList=c.data.data.data,r.isLoading=!1;var d=[],p=[];r.activeList.forEach(function(t){d.push([t.set_address_lng,t.set_address_lat]),p.push(t.price)}),r.adreeList=d,r.priceArr=p}else 3==c.data.code?r.getActive(t,e,i,a,n,s,o,l):0==c.data.code&&alert(c.data.msg)})},handleCurrentChange:function(t){this.pageIndex=t,this.getall()},getVal:function(t){this.content=t},searchHome:function(){this.getall()},toPublish:function(t,e){this.$router.push({path:"/publishPage",query:{information:t.activity_id}})},getShowHigh:function(){var t=window.innerHeight;document.getElementsByClassName("mapStyle")[0].style.height=t-140+"px"},addMarker:function(){for(var t=this,e=(t.markerIndex,t.map),i=t.defultImg,a=t.activeList,n=0;n<t.adreeList.length;n++){s(coordtransform.gcj02tobd09(t.adreeList[n][0],t.adreeList[n][1]),t.priceArr[n],a[n],i)}function s(i,a,n,s){var o=new BMap.Point(i[0],i[1]),l=new BMap.Marker(o);e.addOverlay(l);var r=new function(e,i,a){var n=document.createElement("div");n.style.width="300px";var s=new Image;s.src=e.domain+e.image_url?e.domain+e.image_url:i,s.style.width="300px",s.style.height="200px",s.style.objectFit="cover";var o=document.createElement("h4");o.innerHTML=e.title;var l=document.createElement("p");return l.innerHTML=a?"价格：￥"+a+"/人起":"已过期",n.append(s),n.appendChild(o),n.appendChild(l),n.onclick=function(){t.$router.push({path:"/publishPage",query:{information:e.activity_id}})},n}(n,s,a),c=new BMap.InfoWindow(r);function d(t,e){this._point=t,this._text=e}l.addEventListener("click",function(){this.openInfoWindow(c)}),d.prototype=new BMap.Overlay,d.prototype.initialize=function(t,e,i){this._map=t;var a=this._div=document.createElement("div");a.style.position="absolute",a.style.zIndex=BMap.Overlay.getZIndex(this._point.lat),a.style.zIndex="1",a.style.backgroundColor="white",a.className="markerStyle",a.style.fontFamily="黑体",a.style.height="18px",a.style.padding="4px",a.style.border="1px solid gray",a.style.fontWeight="bold",a.style.color="#000",a.style.fontSize="14px",a.style.whiteSpace="nowrap",a.style.MozUserSlect="none";var n=this._span=document.createElement("span");a.appendChild(n),n.appendChild(document.createTextNode(this._text?"￥"+this._text:"已过期"));var s=this._arrow=document.createElement("div");return s.style.position="absolute",s.className="arrowStyle",s.style.width="0",s.style.height,s.style.border="10px solid rgba(255,255,255,0)",s.style.borderTopColor="rgba(255,255,255,1)",s.style.top="22px",s.style.left="15px",s.style.overflow="hidden",a.appendChild(s),t.getPanes().labelPane.appendChild(a),a},d.prototype.draw=function(){var t=this._map.pointToOverlayPixel(this._point);this._div.style.left=t.x-parseInt(this._arrow.style.left)-11.5+"px",this._div.style.top=t.y-34+"px"};var d=new d(o,a);e.addOverlay(d)}},creatMap:function(t){var e=this,i=e.adress,a=new BMap.Map("mapStyle",{minZoom:5,maxZoom:15});function n(){this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new BMap.Size(10,10)}a.centerAndZoom(i,10),a.disableDoubleClickZoom(),n.prototype=new BMap.Control,n.prototype.initialize=function(t){var e=document.createElement("div"),i=document.createElement("div"),a=document.createElement("div");return i.appendChild(document.createTextNode("+")),a.appendChild(document.createTextNode("-")),e.appendChild(i),e.appendChild(a),e.style.display="flex",e.style.padding="5px",e.style.border="1px solid gray",e.style.borderRadius="5px",e.style.flexWrap="wrap",i.style.borderBottom="1px dashed #000",i.style.width=a.style.width="100%",e.style.fontSize="18px",i.style.cursor=a.style.cursor="pointer",i.style.textAlign=a.style.textAlign="center",e.style.backgroundColor="white",i.onclick=function(){t.getZoom()<15?(t.setZoom(t.getZoom()+1),a.style.color="#000"):i.style.color="#eee"},a.onclick=function(){t.getZoom()>5?(t.setZoom(t.getZoom()-1),i.style.color="#000"):a.style.color="#eee"},t.getContainer().appendChild(e),e};var s=new n;a.addControl(s),a.addEventListener("dragend",function(){var t=a.getBounds(),i=t.getSouthWest(),n=t.getNorthEast();e.westSouth=[i.lng,i.lat],e.eastNorth=[n.lng,n.lat]}),a.addEventListener("zoomend",function(){var t=a.getBounds(),i=t.getSouthWest(),n=t.getNorthEast();e.westSouth=[i.lng,i.lat],e.eastNorth=[n.lng,n.lat]}),e.map=a},getCityImg:function(){var t=this;this.$http.post(this.api+"/CityImage",{token:localStorage.getItem("token"),name:this.adress}).then(function(e){1==e.data.code?t.cityData=e.data.data:3==e.data.code?t.getCityImg():0==e.data.cdoe&&alert(e.data.msg)})}},mounted:function(){window.scroll(0,0),this.getActive(1),this.creatMap(),this.getCityImg(),this.getShowHigh()},created:function(){this.adress=this.$route.query.key,document.title=this.$route.query.key}}),p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"text-align":"left"}},[i("Head",{attrs:{type:"moreActive",content:t.editSearch},on:{getVal:t.getVal,search:t.searchHome}}),t._v(" "),i("div",{staticStyle:{width:"98%","background-color":"#fff","border-top":"1px solid #eee",padding:"10px 1%",position:"fixed",top:"82px","z-index":"99",display:"flex","justify-content":"space-between","border-bottom":"1px solid #eee"}},[i("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[i("el-popover",{attrs:{placement:"bottom",width:"400",trigger:"click"},on:{show:t.show}},[i("el-date-picker",{ref:"saveDateInput",staticStyle:{"margin-left":"20px"},attrs:{"value-format":"timestamp","picker-options":t.pickerOptions2,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),t._v(" "),i("el-button",{attrs:{slot:"reference",type:t.date?"primary":""},slot:"reference"},[t._v("日期")])],1),t._v(" "),i("el-popover",{staticStyle:{"margin-left":"10px"},attrs:{placement:"bottom",width:"350",trigger:"click"}},[t._l(t.otherList,function(e,a){return i("div",{staticStyle:{display:"flex","justify-content":"space-between",margin:"20px"}},[i("div",[i("b",[t._v(t._s(e.person))]),i("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(1==a?"2 - 12岁":2==a?"2岁以下":""))])]),t._v(" "),i("div",[i("el-button",{attrs:{icon:"el-icon-minus",size:"mini",circle:""},on:{click:function(i){t.reduce(e,a)}}}),t._v(" "),i("span",{staticStyle:{margin:"0 10px"}},[t._v(t._s(e.adult))]),t._v(" "),i("el-button",{attrs:{icon:"el-icon-plus",size:"mini",circle:"",disabled:t.addClick},on:{click:function(i){t.add(e,a)}}})],1)])}),t._v(" "),i("div",{staticStyle:{margin:"20px 20px 20px 12px",cursor:"pointer",display:"flex","justify-content":"flex-end"}},[i("span",{on:{click:function(e){t.chooseMoney(1)}}},[t._v("确定")])]),t._v(" "),i("el-button",{attrs:{slot:"reference",type:t.allperson?"primary":""},slot:"reference"},[t._v(t._s(t.allperson?t.allperson+"人+":"体验人数"))])],2),t._v(" "),i("el-popover",{staticStyle:{"margin-left":"10px"},attrs:{placement:"bottom",trigger:"click"}},[i("div",{staticStyle:{"text-align":"center"}},[i("el-radio",{attrs:{label:"1",border:""},model:{value:t.tiyan,callback:function(e){t.tiyan=e},expression:"tiyan"}},[t._v("户外活动")])],1),t._v(" "),i("div",{staticStyle:{"text-align":"center"}},[i("el-radio",{attrs:{label:"2",border:""},model:{value:t.tiyan,callback:function(e){t.tiyan=e},expression:"tiyan"}},[t._v("少数民族")])],1),t._v(" "),i("div",{staticStyle:{"text-align":"center"}},[i("el-radio",{attrs:{label:"3",border:""},model:{value:t.tiyan,callback:function(e){t.tiyan=e},expression:"tiyan"}},[t._v("本土文化")])],1),t._v(" "),i("el-button",{attrs:{slot:"reference",type:t.tiyan.length?"primary":""},slot:"reference"},[t._v("体验类型")])],1),t._v(" "),i("City",{staticStyle:{"margin-left":"10px"},attrs:{type:"3"},on:{selectXian:t.selectXian,checkXian:t.checkXian,selectCountry:t.selectCountry,selectProvince:t.selectProvince,selectCity:t.selectCity}}),t._v(" "),i("el-popover",{staticStyle:{"margin-left":"10px"},attrs:{placement:"bottom",width:"400",trigger:"click"}},[i("div",{staticStyle:{width:"350px","margin-left":"20px"}},[i("el-slider",{attrs:{range:"",max:4e3},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}}),t._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"space-between",margin:"20px 0"}},[i("span",[t._v("￥"+t._s(t.price[0]))]),t._v(" "),i("span",[t._v("￥"+t._s(4e3==t.price[1]?"4000+":t.price[1]))])])],1),t._v(" "),i("div",{staticStyle:{margin:"20px 20px 20px 12px",cursor:"pointer",display:"flex","justify-content":"space-between"}},[i("span",{on:{click:t.rejest}},[t._v("重置")]),i("span",{on:{click:function(e){t.chooseMoney(2)}}},[t._v("确定")])]),t._v(" "),i("el-button",{attrs:{slot:"reference",type:t.allprice[1]?"primary":""},slot:"reference"},[t._v(t._s(t.allprice[1]?t.allprice[0]+"-"+t.allprice[1]:"价格"))])],1),t._v(" "),i("el-popover",{staticStyle:{"margin-left":"10px"},attrs:{placement:"bottom",width:"400",trigger:"click"}},[i("div",{staticStyle:{padding:"20px"}},[i("div",{staticStyle:{display:"flex","justify-content":"space-between",margin:"20px 0"}},[i("div",[i("h4",[t._v("是否需要志愿者")]),t._v(" "),i("p",[t._v("参与体验，帮助策划人与大家交流，沟通等")])]),t._v(" "),i("div",{staticStyle:{width:"70px"}},[i("div",{staticStyle:{transition:"width .5s",overflow:"hidden","border-top-right-radius":"20px","border-bottom-right-radius":"20px","border-top-left-radius":"20px","border-bottom-left-radius":"20px"},style:{width:t.closeIndex?"70px":"30px",backgroundColor:t.closeIndex?"#008489":"#fff"},on:{click:t.change}},[""==t.closeIndex?i("i",{staticClass:"el-icon-circle-close-outline",staticStyle:{"font-size":"30px",float:"left"}}):t._e(),t._v(" "),1==t.closeIndex?i("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{"font-size":"30px","background-color":"#fff","border-radius":"50%",color:"#008489",float:"right"}}):t._e()])])])]),t._v(" "),i("el-button",{attrs:{slot:"reference",type:t.closeIndex?"primary":""},slot:"reference"},[t._v(t._s(t.closeIndex?"需要志愿者":"是否需要志愿者"))])],1)],1),t._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[i("div",{staticStyle:{"margin-right":"10px","line-height":"40px",width:"70px"}},[t._v("\n        显示地图\n      ")]),t._v(" "),i("div",{staticStyle:{width:"70px","margin-top":"5px"}},[i("div",{staticStyle:{transition:"width .5s",overflow:"hidden","border-top-right-radius":"20px","border-bottom-right-radius":"20px","border-top-left-radius":"20px","border-bottom-left-radius":"20px"},style:{width:t.mapIndex?"70px":"30px",backgroundColor:t.mapIndex?"#008489":"#fff"},on:{click:t.Mwpchange}},[0==t.mapIndex?i("i",{staticClass:"el-icon-circle-close-outline",staticStyle:{"font-size":"30px",float:"left"}}):t._e(),t._v(" "),1==t.mapIndex?i("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{"font-size":"30px","background-color":"#fff","border-radius":"50%",color:"#008489",float:"right"}}):t._e()])])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.mapIndex,expression:"!mapIndex"}]},[i("div",{staticStyle:{"margin-top":"142px"}},[i("div",{staticStyle:{position:"relative",height:"380px",padding:"50px 0",display:"flex","align-items":"center","justify-content":"center"}},[i("loadingImg",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.cityData.top_image_url?t.cityData.top_image_url:"",type:"2"}}),t._v(" "),i("div",{staticStyle:{position:"absolute",color:"#fff","text-align":"center"}},[i("div",{staticStyle:{"font-size":"60px",padding:"10px 0"}},[t._v(t._s(t.adress))]),t._v(" "),i("div",{staticStyle:{"font-size":"20px"}},[t._v("选择让您觉得不错的体验")])])],1)]),t._v(" "),i("div",{staticStyle:{width:"1080px",margin:"0 auto"}},[i("h2",{staticStyle:{margin:"20px 0"}},[t._v(t._s(t.adress)+"有"+t._s(t.activeList.length)+"处可订的人人游体验")]),t._v(" "),i("div",{staticStyle:{display:"flex","flex-wrap":"wrap"}},[t._l(t.activeList,function(e,a){return i("div",{key:a,staticClass:"activeMargin",staticStyle:{width:"330px"}},[i("Detail",{attrs:{type:"active",data:e},on:{toPublish:function(i){t.toPublish(e,a)},consult:function(e){t.consult(a)}}})],1)}),t._v(" "),t.activeList.length?t._e():i("div",{staticStyle:{width:"100%"}},[i("None",{attrs:{type:"ALLactive"}})],1),t._v(" "),i("div",{staticStyle:{position:"relative",width:"100%","margin-bottom":"20px",height:"300px",display:"flex","align-items":"center","justify-content":"center"}},[i("loadingImg",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.cityData.bottom_image_url?t.cityData.bottom_image_url:"",type:"2"}}),t._v(" "),t._m(0)],1),t._v(" "),i("div",{staticStyle:{margin:"20px 0","text-align":"center",width:"100%"}},[i("el-pagination",{attrs:{"page-size":10,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],2)])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.mapIndex,expression:"mapIndex"}],staticClass:"flexBetween"},[i("div",{staticClass:"activeList"},[i("div",{staticClass:"title"},[t._v("有"+t._s(t.total)+"个活动")]),t._v(" "),t._l(t.activeList,function(e,a){return i("div",{staticClass:"active_child",on:{click:function(i){t.toPublish(e,a)},mouseenter:function(i){t.changeColorIndex(e,a)}}},[i("Detail",{staticStyle:{width:"100%",height:"100%"},attrs:{type:"mapActive",data:e}})],1)})],2),t._v(" "),i("div",{staticClass:"mapStyle",attrs:{id:"mapStyle"}})]),t._v(" "),t.isLoading?i("div",{staticStyle:{position:"fixed",top:"0",left:"0",bottom:"0",right:"0","background-color":"rgba(255,255,255,0.8)","z-index":"999",display:"flex","justify-content":"center","align-items":"center"}},[i("Loading")],1):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{position:"absolute","font-family":"'华文楷体'",color:"#fff"}},[e("h1",[this._v("更多的体验")]),this._v(" "),e("h1",[this._v("体验可以满足您的所有需求")])])}]};var h=i("VU/8")(d,p,!1,function(t){i("4iW1")},"data-v-091274e6",null);e.default=h.exports}});
//# sourceMappingURL=146.9d185fe82ef8bb792ecd.js.map