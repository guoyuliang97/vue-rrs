webpackJsonp([82],{"9oC+":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("pFYg"),n=i.n(s),a={name:"Ltime",props:["active_id","complete"],data:function(){var e=this;return{api:this.GLOBAL.baseURL,pickerOptions2:{disabledDate:function(t){if(e.timeNumber.length){for(var i="",s=0;s<e.timeNumber.length&&1!=i;s++)i=t.getTime()>=e.parseDate(e.timeNumber[s].begin_date)&&t.getTime()<=e.parseDate(e.timeNumber[s].end_date);return i||t.getTime()<Date.now()-864e5}return t.getTime()<Date.now()-864e5},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]},price:"",money:"",timeNumber:[],personNum:"",startTime:"00:00",endTime:"00:15",longTime:[],madificIndex:"",XG:!1}},watch:{timeNumber:function(){this.timeNumber.length?this.$emit("notChange","1"):this.$emit("notChange","")}},methods:{sort:function(e){for(var t,i,s=e.length,n=1;n<s;n++){for(t=n-1,i=e[n];t>=0&&this.parseDate(e[t].begin_date)>this.parseDate(i.begin_date);)e[t+1]=e[t],t--;e[t+1]=i}},abiosh:function(){this.longTime=[],this.startTime="00:00",this.endTime="00:15",this.personNum="",this.price="",this.XG=!1},modification:function(e,t){this.longTime=[e.begin_date,e.end_date],this.startTime=e.begin_time,this.endTime=e.end_time,this.personNum=e.max_person_num,this.price=e.price,this.madificIndex=t,this.XG=!0},changeRouter:function(){var e=this;this.timeNumber.length?this.active_id?(console.log(111),this.$http.post(this.api+"/home/Activity/save_activity",{token:localStorage.getItem("token"),activity_id:this.active_id,long_day:0,slot:this.timeNumber,step:11}).then(function(t){(t.data.code=1)?e.complete?e.$message({type:"success",message:"保存成功!"}):e.$emit("changeRouter",{id:12,router:"accommodation",information:e.active_id,complete:e.complete}):3==t.data.code?e.changeRouter():0==t.data.code&&e.$alert(t.data.msg)})):(console.log(222),this.$http.post(this.api+"/home/Activity/save_activity",{token:localStorage.getItem("token"),long_day:0,slot:this.timeNumber,step:11}).then(function(t){(t.data.code=1)?(e.$emit("saveId",t.data.data),e.$emit("changeRouter",{id:12,router:"accommodation",information:t.data.data})):3==t.data.code?e.changeRouter():0==t.data.code&&e.$alert(t.data.msg)})):this.$message({type:"info",message:"请填写活动"})},addTime:function(){if(this.longTime.length)if(this.personNum&&/^[1-9]\d*$/.test(this.personNum))if(this.price&&/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/.test(this.price)){if(this.XG)this.timeNumber[this.madificIndex]={begin_date:this.longTime[0],end_date:this.longTime[1],begin_time:this.startTime,end_time:this.endTime,max_person_num:this.personNum,price:this.price},this.XG=!1;else if(this.timeNumber.length){for(var e=[],t=0;t<this.timeNumber.length;t++)this.parseDate(this.timeNumber[t].begin_date)>this.parseDate(this.longTime[0])&&this.parseDate(this.timeNumber[t].begin_date)<this.parseDate(this.longTime[1])&&e.push(t);e.length?this.$message({type:"error",message:"不能添加相同时间段"}):this.timeNumber.push({begin_date:this.longTime[0],end_date:this.longTime[1],begin_time:this.startTime,end_time:this.endTime,max_person_num:this.personNum,price:this.price})}else this.timeNumber.push({begin_date:this.longTime[0],end_date:this.longTime[1],begin_time:this.startTime,end_time:this.endTime,max_person_num:this.personNum,price:this.price});this.longTime=[],this.startTime="00:00",this.endTime="00:15",this.personNum="",this.price="",this.sort(this.timeNumber)}else this.$message({type:"error",message:"请填写正确金额！（最多保留两位小数的正数）"});else this.$message({type:"error",message:"请填写正确活动人数（正整数）"});else this.$message({type:"error",message:"请填写活动时间"})},delet:function(e,t){var i=this;this.$confirm("此操作将删除该时间段，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.slot_id?i.$http.post(i.api+"/SlotD",{token:localStorage.getItem("token"),slot_id:e.slot_id}).then(function(s){1==s.data.code?(i.timeNumber.splice(t,1),i.$message({type:"success",message:"删除成功!"})):3==s.data.code?i.delet(e,t):0==s.data.code&&alert(s.data.msg)}):i.timeNumber.splice(t,1)}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},getActive:function(){var e=this;this.$http.post(this.api+"/ActivityE",{token:localStorage.getItem("token"),activity_id:this.active_id,visit:0}).then(function(t){if(1==t.data.code){var i=t.data.data;if(0==i.long_day)for(var s=0;s<i.slot.length;s++)0==i.slot[s].status&&1!=i.slot[s].online&&e.timeNumber.push({begin_date:i.slot[s].begin_date,end_date:i.slot[s].end_date,begin_time:i.slot[s].begin_time,end_time:i.slot[s].end_time,max_person_num:i.slot[s].max_person_num,price:i.slot[s].price,slot_id:i.slot[s].slot_id})}else 3==t.data.code?e.getActive():0==t.data.code&&e.$alert(t.data.msg)})},parseDate:function(e){return Date.parse(new Date(Date.parse(e.replace(/-/g,"/"))))}},mounted:function(){this.active_id&&this.getActive(),console.log(n()(this.active_id))},created:function(){window.scroll(0,0)}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"line-height":"40px"}},[e.XG?i("div",{staticStyle:{display:"flex","justify-content":"space-between",margin:"20px 0","background-color":"#eee"}},[i("p",[e._v("*您正在修改已创建"),i("span",{staticStyle:{color:"#008489"}},[e._v(e._s(e.longTime[0])+"—"+e._s(e.longTime[1]))]),e._v("的活动时间")]),e._v(" "),i("p",{staticStyle:{color:"#008489"},on:{click:e.abiosh}},[e._v("取消")])]):e._e(),e._v(" "),i("h2",[e._v("介绍活动举办的时间")]),e._v(" "),i("div",{staticClass:"block"},[e._m(0),e._v(" "),i("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions2},model:{value:e.longTime,callback:function(t){e.longTime=t},expression:"longTime"}})],1),e._v(" "),i("div",{staticStyle:{margin:"20px 0"}},[e._m(1),e._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[i("el-time-select",{attrs:{placeholder:"起始时间","picker-options":{start:"00:00",step:"00:15",end:"23:45"}},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}}),e._v(" "),i("el-time-select",{staticStyle:{"margin-left":"20px"},attrs:{placeholder:"结束时间","picker-options":{start:"00:00",step:"00:15",end:"24:00"}},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],1),e._v(" "),i("span",{staticStyle:{"font-size":"12px",color:"#008489"}},[e._v("（小贴士：第一天和最后一天）")])]),e._v(" "),i("div",{staticStyle:{margin:"20px 0"}},[e._m(2),e._v(" "),i("el-input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入人数"},model:{value:e.personNum,callback:function(t){e.personNum=t},expression:"personNum"}})],1),e._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[e._m(3),e._v(" "),i("div",{staticStyle:{border:"1px solid #008489","border-radius":"5px"}},[i("span",{staticStyle:{padding:"0 10px","border-right":"1px solid #008489"}},[e._v("APY(人民币)")]),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"price"}],staticStyle:{width:"200px",border:"none","font-size":"15px"},attrs:{type:"text",placeholder:"请输入价格"},domProps:{value:e.price},on:{input:function(t){t.target.composing||(e.price=t.target.value)}}})])]),e._v(" "),i("div",{staticStyle:{margin:"20px 0"}},[i("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addTime}},[e._v(e._s(e.XG?"保存修改时间":"增加活动时间段"))])],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.timeNumber.length,expression:"timeNumber.length"}]},e._l(e.timeNumber,function(t,s){return i("div",{staticStyle:{margin:"20px 0","border-bottom":"1px solid #008489","font-size":"15px",display:"flex","justify-content":"space-between"}},[i("div",[i("div",[i("span",[e._v("活动时间段：")]),e._v(e._s(t.begin_date)+"——"+e._s(t.end_date))]),e._v(" "),i("div",[i("span",[e._v("开始时间和结束时间：")]),e._v(e._s(t.begin_time)+" - "+e._s(t.end_time))]),e._v(" "),i("div",[i("span",[e._v("活动人数：")]),e._v(e._s(t.max_person_num))]),e._v(" "),i("div",[i("span",[e._v("活动价格：")]),e._v("APY "+e._s(t.price))])]),e._v(" "),i("div",{staticStyle:{color:"#008489","font-size":"20px",cursor:"pointer"}},[i("div",[i("i",{staticClass:"el-icon-delete",on:{click:function(i){e.delet(t,s)}}})]),e._v(" "),i("div",[i("i",{staticClass:"el-icon-edit",on:{click:function(i){e.modification(t,s)}}})])])])})),e._v(" "),i("div",{staticStyle:{margin:"20px 0"}},[i("el-button",{attrs:{type:"primary",plain:""},on:{click:e.changeRouter}},[e._v(e._s(e.complete?"保存":"下一步"))])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticStyle:{"margin-right":"20px"}},[t("b",[this._v("举办活动时间段:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("b",[this._v("活动开始和结束时间:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticStyle:{margin:"20px 0"}},[t("b",[this._v("活动参加人数:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("b",[this._v("活动价格：")])])}]};var r=i("VU/8")(a,o,!1,function(e){i("eui6")},"data-v-6339c204",null);t.default=r.exports},eui6:function(e,t){}});
//# sourceMappingURL=82.0d3a6dbc69d4019e16e1.js.map