webpackJsonp([52],{Pml9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("/nBy"),i=a("uTVu"),s=a("a20G"),o=a("Lt3X"),r=(o.a,s.a,n.a,{name:"SystemMessage",data:function(){return{api:this.GLOBAL.baseURL,messageList:[],total:0,isLoading:!1,userId:"",index:1,page:1,clearNum:""}},components:{Person:o.a,None:s.a,Loading:n.a},methods:{readall:function(){var t=this;this.$http.post(this.api+"/SysMsgReadAll",{token:localStorage.getItem("token")}).then(function(e){1==e.data.code?(t.clearNum="",t.getMessage(),i.a.$emit("clearAll",1)):3==e.data.code?t.readall():alert(e.data.msg)})},handleCurrentChange:function(t){this.page=t,this.getMessage()},check:function(t,e){t.read_user_list.length||this.sendNumber(),this.$router.push({path:"/messagePage",query:{information:t.msg_id}})},getMessage:function(){var t=this;this.isLoading=!0,this.$http.post(this.api+"/sysmsgl",{token:localStorage.getItem("token"),page:this.page}).then(function(e){1==e.data.code?(t.total=e.data.data.total,t.messageList=e.data.data.data,t.isLoading=!1):3==e.data.code?t.$http.post(t.api+"/home/index/token").then(function(e){localStorage.setItem("token",e.data.data),t.getMessage(val)}):0==e.data.code&&(t.isLoading=!1,alert(e.data.msg))})},sendNumber:function(){i.a.$emit("reduce",1)}},mounted:function(){this.getMessage(1)},created:function(){var t=this;this.userId=this.$route.query.information,this.clearNum=this.$route.query.clearNum,i.a.$on("alearAll",function(e){e&&(t.clearNum=0)})}}),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"text-align":"left"}},[a("div",{staticStyle:{"text-align":"right","font-size":"13px","font-weight":"bold",cursor:"pointer"},style:{color:t.clearNum?"#008489":"#8e8e8e"}},[a("span",{on:{click:function(e){t.clearNum&&t.readall()}}},[t._v(t._s(t.clearNum?"全部标为已读":"全部为已读"))])]),t._v(" "),t._l(t.messageList,function(e,n){return a("div",{staticStyle:{"margin-bottom":"20px","line-height":"30px",cursor:"pointer",display:"flex","justify-content":"space-between","border-bottom":"1px solid #eee"},on:{click:function(a){t.check(e,n)}}},[a("div",[a("p",[t._v(t._s(e.title))]),t._v(" "),a("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(e.send_time))])]),t._v(" "),a("div",[a("el-badge",{staticClass:"item",attrs:{value:-1!==e.read_user_list.indexOf(t.userId)?"":"1"}})],1)])}),t._v(" "),t.messageList.length?t._e():a("None",{attrs:{type:"message"}}),t._v(" "),a("div",{staticStyle:{margin:"20px 0","text-align":"center"}},[a("el-pagination",{attrs:{"current-page":t.index,"page-size":10,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.index=e}}})],1),t._v(" "),t.isLoading?a("div",{staticStyle:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0","z-index":"999","background-color":"rgba(255,255,255,.8)",display:"flex","justify-content":"center","align-items":"center"}},[a("Loading")],1):t._e()],2)},staticRenderFns:[]};var c=a("VU/8")(r,l,!1,function(t){a("UjeV")},"data-v-a0ecca96",null);e.default=c.exports},UjeV:function(t,e){}});
//# sourceMappingURL=52.5b1bc37628357946736e.js.map