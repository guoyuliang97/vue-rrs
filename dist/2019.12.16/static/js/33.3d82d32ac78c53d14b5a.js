webpackJsonp([33],{YOiJ:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=e("uTVu"),s={data:function(){return{api:this.GLOBAL.baseURL,imgUrl:"../../../static/img/static/user.png",isSuccess:!1,isUpload:!1,upData:{token:localStorage.getItem("token")}}},methods:{handleAvatarSuccess:function(t,a){this.imgUrl=URL.createObjectURL(a.raw),localStorage.setItem("userImg",t.data.domain+t.data.image_url),this.savePhoto(t)},savePhoto:function(t){var a=this;this.$http.post(this.api+"/home/User/saveuser",{token:localStorage.getItem("token"),head_image:t.data.image_id}).then(function(t){1==t.data.code?o.a.$emit("userImage",a.imgUrl):3==t.data.code?a.$http.post(a.api+"/home/index/token").then(function(t){localStorage.setItem("token",t.data.data),a.savePhoto()}):alert(t.data.msg)})},beforeAvatarUpload:function(t){var a="image/jpeg"===t.type,e=t.size/1024/1024<2;return a||this.$message.error("上传照片只能是jpg格式"),e||this.$message.error("上传图片大小不能超过5M"),a&&e},uploadProgress:function(){this.isSuccess=!0,this.isUpload=!1},delPhoto:function(){var t=this;"../../../static/img/static/user.png"!=this.imgUrl&&this.$confirm("确定要删除此照片?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.removePhoto()}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},removePhoto:function(){var t=this;this.$http.post(this.api+"/home/User/saveuser",{token:localStorage.getItem("token"),head_image:""}).then(function(a){1==a.data.code?(t.imgUrl="../../../static/img/static/user.png",t.$message({type:"success",message:"删除成功!"})):3==a.data.code?t.$http.post(t.api+"/home/index/token").then(function(a){localStorage.setItem("token",a.data.data),t.removePhoto()}):alert(a.data.msg)})}},mounted:function(){var t=this;this.$http.post(this.api+"/home/User/get_user",{token:localStorage.getItem("token")}).then(function(a){1==a.data.code?a.data.data[0].headimage?t.imgUrl=a.data.data[0].headimage.domain+a.data.data[0].headimage.image_url:t.imgUrl="../../../static/img/static/user.png":(a.data.code,t.$router.push("/"),localStorage.removeItem("isLogin"))}).catch(function(t){alert(t)})}},i={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"mandatory"},[t._m(0),t._v(" "),e("div",{staticClass:"edit_datacon"},[e("div",{staticClass:"editphoto_con",style:{backgroundImage:"url("+t.imgUrl+")",backgroundSize:"100% 100%"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isUpload&&!t.isSuccess,expression:"isUpload&&!isSuccess"}],staticStyle:{position:"absolute",top:"0",right:"0",bottom:"0",left:"0","background-color":"rgba(0,0,0,.6)","z-index":"99","line-height":"180px",color:"#008489","font-size":"24px"}},[e("i",{staticClass:"el-icon-loading"})]),t._v(" "),e("p",{staticClass:"fontweight",staticStyle:{position:"absolute",top:"2px",right:"2px",color:"#333333","font-size":"18px","z-index":"98",cursor:"pointer"},on:{click:t.delPhoto}},[e("i",{staticClass:"el-icon-delete"})]),t._v(" "),e("div",{staticStyle:{position:"absolute",left:"0",right:"0",top:"0",bottom:"0","background-color":"rgba(255,255,255,.5)"}}),t._v(" "),e("div",{staticClass:"editphoto_head",style:{backgroundImage:"url("+t.imgUrl+")",backgroundSize:"100% 100%"}})]),t._v(" "),e("div",{staticClass:"editPhoto_txt"},[t._v("清晰的正面脸部照片是房东和房客互相认识对方的重要途径。您能想象把自己的房子租给一只猫吗？ 请确保使用能够清楚显示您面部的照片，并确认其中不包含任何您不希望其他房东或房客看到的个人或敏感信息。")]),t._v(" "),e("div",{staticClass:"editphoto_upload fontweight"},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.api+"/home/Upload/upload",data:t.upData,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,"on-progress":t.uploadProgress}},[t.imgUrl?e("img",{staticClass:"avatar",attrs:{src:t.imgUrl}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v("\n\t\t\t\t上传照片\n\t\t\t\t")],1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"data_title"},[a("div",{staticClass:"edit_width"},[this._v("个人头像")])])}]};var n=e("VU/8")(s,i,!1,function(t){e("wAGO")},null,null);a.default=n.exports},wAGO:function(t,a){}});
//# sourceMappingURL=33.3d82d32ac78c53d14b5a.js.map