{"version":3,"sources":["webpack:///./src/public/videoUpload.vue","webpack:///./src/public/videoUpload.vue?8c49","webpack:///./src/public/videoUpload.vue?fe15"],"names":["Vue","use","EXIF","public_videoUpload","name","data","api","param","imageList","fileAllList","index","token","methods","seletI","event","_this2","this","asyncToGenerator_default","regenerator_default","a","mark","_callee","_this","wrap","_context","prev","next","isLoading","xunhuan","stop","_this3","_callee2","_context2","console","log","FormData","target","files","length","panduan","fileAll","Orientation","upload","file","isJap","type","isVedio","alert","url","URL","createObjectURL","audioElement","Audio","addEventListener","duration","$message","message","append","getData","getAllTags","getTag","oReader","FileReader","onload","e","image","Image","src","result","expectWidth","naturalWidth","expectHeight","naturalHeight","canvas","document","createElement","ctx","getContext","width","height","drawImage","base64","rotateImg","toDataURL","readAsDataURL","img","direction","step","degree","Math","PI","rotate","_this4","localStorage","getItem","$http","post","then","res","code","i","push","domain","image_url","image_id","$refs","value","msg","mounted","selectortype_template_index_0_src_public_videoUpload","render","_vm","_h","$createElement","_c","_self","staticStyle","margin-top","staticClass","font-size","_v","ref","attrs","multiple","on","change","color","margin","display","flex-wrap","_l","item","directives","rawName","list","group","expression","key","background-size","margin-right","style","backgroundImage","position","background-color","top","left","justify-content","margin-left","cursor","click","$event","uploadLook","uploadDelet","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/131.9f51276f545bafad3b8f.js","sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n  import Vue from \"vue\"\n  import EXIF from \"exif-js\"\n  Vue.use(EXIF)\n    export default {\n        name: \"videoUpload\",\n      data(){\n          return{\n            api: 'https://www.allptp.top/allptp',\n            param:'',\n            imageList:[],\n            fileAllList:[],\n            index:0,\n            token: '9556d15c8fa0c8f5248a02d603cd3956'\n          }\n      },\n      methods:{\n        async seletI(event){\n          let _this = this\n          _this.isLoading = true\n          _this.xunhuan(event)\n\n\n        },\n        async xunhuan(event){\n          console.log(1)\n          let _this = this\n          var param = new FormData()\n          if(event.target.files.length){\n            this.panduan(event.target.files,param)\n          }\n        },\n        panduan(fileAll,param){\n          var Orientation = null;\n          let _this = this\n          if(fileAll.length>0&& this.index ==  fileAll.length ){\n            this.index = 0\n            this.param = param\n            this.upload()\n            return;\n          }else{\n            var file = fileAll[this.index]\n            const isJap = file.type === 'image/jpeg' || file.type === 'image/jpg' || file.type === 'image/png'\n            const isVedio = file.type === 'video/mp4'\n            if (!isJap && !isVedio) {\n              alert('请上传图片格式IPEG/PNG/JPG或者视频格式mp4')\n              _this.isLoading = false\n              return false;\n            }else if(isVedio) {\n              var url = URL.createObjectURL(file)\n              var audioElement = new Audio(url);\n              var duration;\n              audioElement.addEventListener(\"loadedmetadata\", function () {\n                duration = audioElement.duration;\n                if (duration > 10) {\n                  _this.$message({\n                    type: 'error',\n                    message: '上传视频不能大于10s'\n                  })\n                  _this.isLoading = false\n                  return false\n                } else {\n                  param.append('file[]', file)\n                }\n              })\n            }else {\n              EXIF.getData(file, function () {\n                EXIF.getAllTags(this);\n                Orientation = EXIF.getTag(this, 'Orientation');\n              });\n              var oReader = new FileReader();\n              oReader.onload = function (e) {\n\n                var image = new Image();\n                image.src = e.target.result;\n                image.onload = function () {\n\n                  var expectWidth = this.naturalWidth;\n                  var expectHeight = this.naturalHeight;\n                  var canvas = document.createElement(\"canvas\");\n                  var ctx = canvas.getContext(\"2d\");\n                  canvas.width = expectWidth;\n                  canvas.height = expectHeight;\n                  ctx.drawImage(this, 0, 0, expectWidth, expectHeight);\n                  var base64 = null;\n                  if (Orientation != \"\" && Orientation != 1) {\n                    switch (Orientation) {\n                      case 6://需要顺时针（向左）90度旋转\n//                      alert('需要顺时针（向左）90度旋转');\n                        _this.rotateImg(this, 'left', canvas);\n                        break;\n                      case 8://需要逆时针（向右）90度旋转\n//                      alert('需要顺时针（向右）90度旋转');\n                        _this.rotateImg(this, 'right', canvas);\n                        break;\n                      case 3://需要180度旋转\n//                      alert('需要180度旋转');\n                        /* /!*this.rotateImg(this,'right',canvas);//转两次*/\n                        /*    this.rotateImg(this,'right',canvas);*!/*/\n                        _this.rotateImg(this, 'turntwo', canvas);\n                        break;\n                    }\n                    base64 = canvas.toDataURL(\"image/jpeg\", 0.8);\n                    param.append('file[]', base64)\n                  }else{\n                    base64 = canvas.toDataURL(\"image/jpeg\", 0.8);\n                    param.append('file[]', base64)\n                  }\n                  _this.index++;\n                  _this.panduan(fileAll,param)\n                }\n              };\n              oReader.readAsDataURL(file)\n            }\n          }\n        },\n        rotateImg(img, direction,canvas){\n\n          var min_step = 0;\n          var max_step = 3;\n          //var img = document.getElementById(pid);\n          if (img == null)return;\n          //img的高度和宽度不能在img元素隐藏后获取，否则会出错\n          var height = img.height;\n          var width = img.width;\n          //var step = img.getAttribute('step');\n          var step = 2;\n          if (step == null) {\n            step = min_step;\n          }\n          if (direction == 'right') {\n            step++;\n            //旋转到原位置，即超过最大值\n            step > max_step && (step = min_step);\n          } else {\n            step--;\n            step < min_step && (step = max_step);\n          }\n          //旋转角度以弧度值为参数\n          var degree = step * 90 * Math.PI / 180;\n          var ctx = canvas.getContext('2d');\n          switch (step) {\n            case 0:\n              canvas.width = width;\n              canvas.height = height;\n              ctx.drawImage(img, 0, 0);\n              break;\n            case 1:\n              canvas.width = height;\n              canvas.height = width;\n              ctx.rotate(degree);\n              ctx.drawImage(img, 0, -height);\n              break;\n            case 2:\n              canvas.width = width;\n              canvas.height = height;\n              ctx.rotate(degree);\n              ctx.drawImage(img, -width, -height);\n              break;\n            case 3:\n              canvas.width = height;\n              canvas.height = width;\n              ctx.rotate(degree);\n              ctx.drawImage(img, -width, 0);\n              break;\n          }\n        },\n        upload(){\n          this.param.append('token', localStorage.getItem('token'))\n          this.$http.post(this.api + '/home/Upload/upload_many', this.param)\n            .then(res=>{\n              if(res.data.code == 1){\n                console.log(res)\n                let data = res.data.data\n                console.log(res)\n                  for(let i =0;i< data.length; i++){\n                    this.fileAllList.push({url:data[i].domain + data[i].image_url,image_id:data[i].image_id})\n                  }\n                  this.$refs.file.value = ''\n              }else if(res.data.code == 3){\n                console.log(3)\n                this.token = localStorage.getItem('token')\n                this.upload()\n               /* this.$http.post(this.api + '/home/index/token')\n                  .then(res=>{\n                    localStorage.setItem('token',res.data.data)\n                    this.upload()\n                  })*/\n              }else if(res.data.code == 0){\n                alert(res.data.msg)\n                this.isLoading = false\n              }\n            })\n        },\n      },\n      mounted(){\n\n      }\n    }\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/videoUpload.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"margin-top\":\"30px\"}},[_c('div',{staticClass:\"formFile\"},[_c('i',{staticClass:\"el-icon-plus\",staticStyle:{\"font-size\":\"30px\"}}),_vm._v(\" \"),_c('input',{ref:\"file\",staticClass:\"upload\",attrs:{\"type\":\"file\",\"multiple\":\"\"},on:{\"change\":_vm.seletI}})])]),_vm._v(\" \"),_c('p',{staticStyle:{\"font-size\":\"12px\",\"color\":\"#008489\",\"margin\":\"10px 0\"}},[_vm._v(\"（小贴士：可以对您的照片进行排序再保存）\")]),_vm._v(\" \"),_c('div',{staticStyle:{\"display\":\"flex\",\"flex-wrap\":\"wrap\"}},_vm._l((_vm.fileAllList),function(item,index){return _c('div',{directives:[{name:\"dragging\",rawName:\"v-dragging\",value:({ item: item, list: _vm.fileAllList, group: 'item' }),expression:\"{ item: item, list: fileAllList, group: 'item' }\"}],key:index,staticStyle:{\"margin\":\"20px 0\"}},[_c('div',{staticStyle:{\"width\":\"150px\",\"height\":\"150px\",\"background-size\":\"auto 100%\",\"margin-right\":\"20px\"},style:({backgroundImage: 'url('+item.url+')'})},[_c('div',{staticStyle:{\"width\":\"150px\",\"height\":\"150px\",\"position\":\"relative\",\"background-color\":\"rgba(0,0,0,.3)\"}},[_c('div',{staticStyle:{\"position\":\"absolute\",\"top\":\"50%\",\"left\":\"50%\",\"width\":\"50px\",\"height\":\"20px\",\"display\":\"flex\",\"justify-content\":\"flex-start\",\"margin-left\":\"-25px\",\"margin-top\":\"-10px\"}},[_c('i',{staticClass:\"el-icon-zoom-in\",staticStyle:{\"font-size\":\"20px\",\"color\":\"white\",\"cursor\":\"pointer\"},on:{\"click\":function($event){_vm.uploadLook(item,index)}}}),_c('i',{staticClass:\"el-icon-delete\",staticStyle:{\"font-size\":\"20px\",\"color\":\"white\",\"margin-left\":\"10px\",\"cursor\":\"pointer\"},on:{\"click\":function($event){_vm.uploadDelet(item,index)}}})])])])])}))])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2b4995f7\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/public/videoUpload.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2b4995f7\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vux-loader/src/style-loader.js!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./videoUpload.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./videoUpload.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./videoUpload.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2b4995f7\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../node_modules/vux-loader/src/template-loader.js!../../node_modules/vue-loader/lib/selector?type=template&index=0!./videoUpload.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-2b4995f7\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/public/videoUpload.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}